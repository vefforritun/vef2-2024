---
title: React
---

## React

### Vefforritun

### √ìlafur Sverrir Kjartansson, [osk@hi.is](mailto:osk@hi.is)

---

## Sagan

* Fr√° √æv√≠ a√∞ [‚ÄûWeb 2.0‚Äú](https://en.wikipedia.org/wiki/Web_2.0) var skilgreint 2004 hafa vefir veri√∞ a√∞ ver√∞a fl√≥knari
* jQuery og √∂nnur DOM tengd library komu kringum 2005 og hj√°lpu√∞u vi√∞ a√∞ sm√≠√∞a cross-browser vefi
* St√¶rri ‚Äûframework‚Äú til a√∞ skrifa vefi komu fram, t.d. Dojo, ExtJs, Backbone o.fl.

***

## Single page application

* Single page application e√∞a _SPA_ eru vefforrit sem, eftir fyrsta load, framkv√¶ma mj√∂g sjaldan ‚Äûrefresh‚Äú
* Vefur hagar s√©r meira eins og desktop forrit
* F√°um n√Ω g√∂gn fr√° vef√æj√≥n me√∞ Ajax e√∞a √°l√≠ka

***

* Flest af √æessum st√¶rri JS frameworks/libraries bj√≥√∞a upp √° svona virkni
  * √Åsamt m√∂rgu fleiru...
* Vi√∞ √¶tlum a√∞ kafa nokku√∞ dj√∫pt √≠ React

***

<!-- eslint-disable no-unused-vars, no-undef, react/react-in-jsx-scope, constructor-super , no-this-before-super, lines-between-class-members -->

```javascript
export class Toggle extends Component {
  constructor() {
    this.state = { toggled: true };
  }
  handleClick() {
    this.setState((prev) => ({
      toggled: !prev.toggled,
    }));
  }
  render() {
    return (
      <button onClick={this.handleClick}>
        {this.state.toggled ? 'ON' : 'OFF'}
      </button>
    );
  }
}
```

***

<!-- eslint-disable no-unused-vars, no-undef, react/react-in-jsx-scope -->

```javascript
export function Toggle() {
  const [toggled, setToggled] = useState(false);

  const handleClick = () => {
    setToggled(!toggled);
  };

  return (
    <button onClick={this.handleClick}>
      {toggled ? 'ON' : 'OFF'}
    </button>
  );
}
```

***

## Grunnhugmynd React

* React byggir √° √æv√≠ a√∞ a√∞skilna√∞ur milli markup √≠ formi template m√°la og l√≥g√≠kar (JavaScript) s√© √≥r√∂kr√©ttur
  * Template m√°l hafa √∂√∞ruv√≠si, ekki jafn kr√∂ftugan syntax
* Markup og l√≥g√≠k eru √≠ e√∞li s√≠nu tengd saman og √æessi a√∞skilna√∞ur byggir _√° t√¶kni_

***

* Highly cohesive
  * Hver hluti inniheldur lang flest sem √æarf til birtingar og notkunar
* Loosely coupled
  * Hver hluti er sj√°lfum s√©r n√¶gur og √æarf ekki a√∞ra hluti

***

## Keyrsla

* √ûurfum a√∞ setja upp umhverfi til a√∞ keyra React verkefni
* Getum byrja√∞ fr√° grunni en borgar sig a√∞ nota ‚Äûstarter kit‚Äú

---

## Starter kits

* M√∂rg t√¶ki og t√≥l sem eru notu√∞ vi√∞ √ær√≥un √° react verkefnum
  * webpack, react, babel, eslint, redux, stylelint, sass, postcss, o.fl.
* Unopinionated‚ÄîLeysir grunnverkefni en tiltekur ekki √°kve√∞in t√≥l
* Opinionated‚ÄîLeysir √°kve√∞nari verkefni me√∞ √°kve√∞num t√≥lum

***

## [create react app](https://github.com/facebook/create-react-app) (cra)

* Starter kit fyrir react sem er vi√∞haldi√∞ af react teyminu
* ‚ÄûZero config‚Äú
  * Getur byrja√∞ a√∞ vinna √°n √æess a√∞ stilla s√©rstaklega
* Felur lang flestar fl√¶kjur
* Unopinionated
* G√≥√∞ur sta√∞ur til a√∞ byrja √°

***

## create react app

* Munum nota √≠ okkar verkefnum
* Getum s√≠√∞an ‚Äûsloppi√∞‚Äú fr√° create react app me√∞ `npm run eject`
  * F√¶rir √∂ll dependency, t√≥l og build ferli inn √≠ project

***

## create react app ‚Äì uppsetning

```bash
> npx create-react-app my-app
> cd my-app
> npm start
```

***

## create react app t√≥l

* √ûegar vi√∞ keyrum f√°um vi√∞:
  * l√°gmarks linting
  * hot reload ‚ú®
* √ñll verkefni munu **a√∞eins** keyra √° client
  *Client side rendering **ekki** server side rendering

***

## CRA og eslint

* Kemur uppsett me√∞ eslint
* √ûurfum a√∞ [b√¶ta vi√∞ `.eslintrc.json` skr√° √≠ verkefni](https://facebook.github.io/create-react-app/docs/setting-up-your-editor#displaying-lint-output-in-the-editor) til a√∞ sj√°ist r√©tt √≠ editor
* E√∞a b√¶ta vi√∞ lykli √≠ `package.json`

***

`.eslntrc.json`

```json
{
  "extends": "react-app"
}
```

`package.json`

```json
"eslintConfig": {
  "extends": "react-app"
}
```

***

## [React DevTools](https://github.com/facebook/react-devtools)

* Extension fyrir [Chrome](https://chrome.google.com/webstore/detail/react-developer-tools/fmkadmapgofadopljbjfkapdkoienihi) og [Firefox](https://addons.mozilla.org/firefox/addon/react-devtools/)
* Leyfir okkur a√∞ sko√∞a _componenta_, _prop_ og _state_

***

## Developer experience

* Ein af meginreglum vi√∞ √ær√≥un √° React er a√∞ √æa√∞ eigi a√∞ vera au√∞velt fyrir forritarann
  * G√≥√∞ skj√∂lun
  * G√≥√∞ villuskilabo√∞

***

* Auka hlutir sem hj√°lpa
  * L√°ti√∞ vita af algengnum innsl√°ttarvillum
  * Validation √° DOM tr√©
  * o.fl.

---

## JSX

* JSX er vi√∞b√≥t vi√∞ JavaScript sem leyfir okkur a√∞ l√Ωsa vi√∞m√≥ti
* Blandar saman HTML elementum, React componentum og JavaScript
* üò±

***

## JSX tr√©

* Myndar _tr√©_ eins og DOM
  * JSX m√° hrei√∞ra
* Element sem byrja √° st√≥rum staf eru **React element**
  * K√∂llum l√≠ke _React component_
* Element sem byrja √° litlum staf eru t√∫lku√∞ sem DOM element
* √ñll lauf tr√©s eru DOM element

***

* Vefjum JSX yfirleitt √≠ `()` til a√∞ koma √≠ vef fyrir automatic semicolon insertion
* Innan `{}` √≠ JSX getum vi√∞ sett JavaScript seg√∞ir
  * `(<p>Test {[1, 2, 3].join(', ')}</p>)`
* JSX er l√≠ka t√∫lka√∞ sem seg√∞
  * `return (<h1>Hello world!</h1>);`

***

* Element √≠ JSX geta haft attribute, eru send inn sem _props_  √≠ component
  *Skrifu√∞ me√∞ camelCase
  * `{}` fyrir expression, `""` fyrir strengi
  * Fr√≠standandi attribute (√°n gildis) er t√∫lka√∞ sem `true`
  * `class` er fr√°teki√∞ or√∞ √≠ JavaScript og notum √æv√≠ `className`

***

* √ñll gildi sem t√∫lku√∞ eru √≠ JSX eru _escaped_, verndar fyrir XSS
* Ver√∞um a√∞ nota self-closing syntax √∫r XML/XHTML
  * `(<img src={img.url} />)`
  * `(<MyInput required />)`

***

## JSX t√∫lka√∞

* JSX er _syntactic sugar_ fyrir kall √≠ `React.createElement`
* Eftir √æ√Ω√∞ingu ver√∞a allar JSX seg√∞ir endurkv√¶mt k√∂ll √≠ √æa√∞
* Til √æess a√∞ JSX virki yfirh√∂fu√∞ √æarf _yfirleitt_ a√∞ vera b√∫i√∞ a√∞ `import`a React:
  * `import React from 'react'`
* Sum t√≥l leyfa √æ√©r a√∞ stilla √æannig a√∞ √æa√∞ √æurfi ekki

***

<!-- eslint-disable no-unused-vars, no-undef, react/react-in-jsx-scope, constructor-super , no-this-before-super-->

```javascript
const element = (
  <h1 className="greeting">
    <span>Hello, world!</span>
  </h1>
);
```

er t√∫lka√∞ sem

<!-- eslint-disable no-unused-vars, no-undef, react/react-in-jsx-scope, constructor-super , no-this-before-super-->

```javascript
const element = React.createElement(
  'h1',
  { className: 'greeting' },
  React.createElement(
    'span',
    null,
    'Hello, world!',
  ),
);
```

---

## Declarative API

* React hefur _declarative API_
  * Eins og HTML
* Vi√∞ segjum hvernig vi√∞ viljum a√∞ UI s√© og react passar upp√° a√∞ √æa√∞ passi
* √ìl√≠kt _imperative_ API √æar sem vi√∞ framkv√¶mum skref-fyrir-skref √æa√∞ sem √æarf til a√∞ UI s√© r√©tt

***

* Declarative: ‚ÄûBirtu takka sem stendur √° h√¶‚Äú
* Imperative:
  * B√∫√∞u til `button` element
  * B√¶ttu vi√∞ `h√¶` sem texta element innan takka
  * B√¶ttu takka vi√∞ DOM

***

## React element og DOM

* √ûar sem JSX element eru ekki DOM element er t√∂luvert √≥d√Ωrara a√∞ b√∫a √æau til
  * √ûar til √° einhverjum t√≠mapunkti sem vi√∞ b√∫um til DOM element √≠ raun

***

* Til a√∞ b√∫a til DOM tr√© k√∂llum vi√∞ √≠ fall fr√° ReactDOM og gefum r√≥t tr√©s √°samt DOM n√≥√∞u sem mun innihalda ni√∞urst√∂√∞u, oft n√≥√∞a me√∞ `id` `root`
* `ReactDOM.render(element, document.getElementById('root'));`
  * Allt DOM tr√© fyrir `element` ver√∞ur b√∫i√∞ til og sett undir element me√∞ id `root`

***

## Uppf√¶rsla √≠ DOM

* Ef eitthva√∞ l√¶tur `element` breytast e√∞a ef vi√∞ k√∂llum aftur √≠ `render` mun React _a√∞eins uppf√¶ra_ √æa√∞ sem breyttist
* React heldur utan um ‚Äûvirtual DOM‚Äú (VDOM) sem er sta√∞a √° UI geymd √≠ minni sem er s√≠√∞an syncu√∞ vi√∞ alv√∂ru DOM
  * √ûetta sync er kalla√∞ [reconciliation](https://reactjs.org/docs/reconciliation.html)

***

* √ûurfum **ekki** a√∞ tilgreina neinar DOM a√∞ger√∞ir (`createElement`, `appendChild`, `removeChild` o.s.fr.), React s√©r um √æa√∞
  * Declarative!
* Uppf√¶rsla mun eiga s√©r sta√∞ ef kalla√∞ er aftur √≠ `render` e√∞a ef √° einhverjum t√≠mapunkti, √≠ einhverju component er `state` uppf√¶rt, en √æa√∞ mun uppf√¶ra hluttr√© fr√° √æeim component

***

## Reconciliation

* ‚ÄûDiff‚Äú sem er keyrt √° vdom og dom og uppf√¶rir **a√∞eins √æa√∞ sem √æarf a√∞ breyta** til a√∞ l√°ta passa
* Bestu reiknirit til a√∞ breyta einu tr√© √≠ anna√∞ kosta √≠ kringum O(n¬≥) svo React √æarf a√∞ stytta s√©r lei√∞
  * √ñllu hluttr√© er hent ef foreldri breytist
  * Fyrir lista af hlutum √¶tti forritari a√∞ l√°ta vita hvort breytingar hafi √°tt s√©r sta√∞ me√∞ `key` attribute, gefum lista _stable id_

***

## Reconciliation reiknirit

1. React b√Ωr til n√Ωtt VDOM
2. Diffar vi√∞ gamla
3. √ötb√Ωr minnsta sett af DOM a√∞ger√∞um til a√∞ breyta √° milli
4. Framkv√¶mir a√∞ger√∞ir

***

## Create react app + TypeScript

* Getum √∫tb√∫i√∞ create react app project me√∞ typescript stu√∞ning
* B√¶tum vi√∞ `--template typescript` √æegar vi√∞ b√∫um til verkefni
  * `npx create-react-app my-app --template typescript`
* [Create React App: Adding TypeScript](https://create-react-app.dev/docs/adding-typescript/)

***

## React og TypeScript

* Nefnum skj√∂l sem innihalda jsx `.tsx`
* H√∂fum √°kve√∞nar t√Ωpur fyrir React
* T.d. `React.FormEvent<HTMLButtonElement>`
  * Gefur okkur autocomplete og tryggingu √° a√∞ vi√∞ s√©um a√∞ vinna r√©tt me√∞ event

***

* √ûurfum ekki `PropTypes`, notum interfaces e√∞a types
* `useState` er generic og √æurfum a√∞ skilgreina ef vi√∞ erum me√∞ fylki e√∞a hluti
  * `useState<string>(defaultValue);`
